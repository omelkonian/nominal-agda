<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Nominal.Abs.Support</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/nominal-agda/tree/master/Nominal/Abs/Support.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="25" class="Symbol">;</a> <a id="27" class="Keyword">open</a> <a id="32" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="42" class="Keyword">open</a> <a id="47" href="Prelude.Init.html#7118" class="Module">L.Mem</a>
<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="Prelude.InfEnumerable.html" class="Module">Prelude.InfEnumerable</a>

<a id="206" class="Keyword">module</a> <a id="213" href="Nominal.Abs.Support.html" class="Module">Nominal.Abs.Support</a> <a id="233" class="Symbol">(</a><a id="234" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a> <a id="239" class="Symbol">:</a> <a id="241" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="245" class="Symbol">)</a> <a id="247" class="Symbol">⦃</a> <a id="249" href="Nominal.Abs.Support.html#249" class="Bound">_</a> <a id="251" class="Symbol">:</a> <a id="253" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="259" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a> <a id="264" class="Symbol">⦄</a> <a id="266" class="Symbol">⦃</a> <a id="268" href="Nominal.Abs.Support.html#268" class="Bound">_</a> <a id="270" class="Symbol">:</a> <a id="272" href="Prelude.InfEnumerable.html#663" class="Record">Enumerable∞</a> <a id="284" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a> <a id="289" class="Symbol">⦄</a> <a id="291" class="Keyword">where</a>

<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Nominal.New.html" class="Module">Nominal.New</a>      <a id="327" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Nominal.Swap.html" class="Module">Nominal.Swap</a>     <a id="361" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a>
<a id="366" class="Keyword">open</a> <a id="371" class="Keyword">import</a> <a id="378" href="Nominal.Support.html" class="Module">Nominal.Support</a>  <a id="395" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a>
<a id="400" class="Keyword">open</a> <a id="405" class="Keyword">import</a> <a id="412" href="Nominal.Abs.Base.html" class="Module">Nominal.Abs.Base</a> <a id="429" href="Nominal.Abs.Support.html#234" class="Bound">Atom</a>

<a id="435" class="Keyword">module</a> <a id="442" href="Nominal.Abs.Support.html#442" class="Module">_</a> <a id="444" class="Symbol">{</a><a id="445" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="447" class="Symbol">:</a> <a id="449" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="454" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="455" class="Symbol">}</a>
  <a id="459" class="Symbol">⦃</a> <a id="461" href="Nominal.Abs.Support.html#461" class="Bound">_</a> <a id="463" class="Symbol">:</a> <a id="465" href="Prelude.Setoid.Core.html#107" class="Record">ISetoid</a> <a id="473" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="475" class="Symbol">⦄</a> <a id="477" class="Symbol">⦃</a> <a id="479" href="Nominal.Abs.Support.html#479" class="Bound">_</a> <a id="481" class="Symbol">:</a> <a id="483" href="Prelude.Setoid.Core.html#307" class="Record">SetoidLaws</a> <a id="494" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="496" class="Symbol">⦄</a>
  <a id="500" class="Symbol">⦃</a> <a id="502" href="Nominal.Abs.Support.html#502" class="Bound">_</a> <a id="504" class="Symbol">:</a> <a id="506" href="Nominal.Swap.Base.html#401" class="Record">Swap</a> <a id="511" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="513" class="Symbol">⦄</a> <a id="515" class="Symbol">⦃</a> <a id="517" href="Nominal.Abs.Support.html#517" class="Bound">_</a> <a id="519" class="Symbol">:</a> <a id="521" href="Nominal.Swap.Base.html#2629" class="Record">SwapLaws</a> <a id="530" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="532" class="Symbol">⦄</a>
  <a id="536" class="Symbol">⦃</a> <a id="538" href="Nominal.Abs.Support.html#538" class="Bound">_</a> <a id="540" class="Symbol">:</a> <a id="542" href="Nominal.Support.html#1286" class="Record">FinitelySupported</a> <a id="560" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="562" class="Symbol">⦄</a> <a id="564" class="Keyword">where</a>

  <a id="573" class="Comment">-- abstractions over finitely supported types are themselves finite</a>
  <a id="643" class="Keyword">instance</a>
    <a id="656" href="Nominal.Abs.Support.html#656" class="Function">FinSupp-Abs</a> <a id="668" class="Symbol">:</a> <a id="670" href="Nominal.Support.html#1286" class="Record">FinitelySupported</a> <a id="688" class="Symbol">(</a><a id="689" href="Nominal.Abs.Base.html#437" class="Record">Abs</a> <a id="693" href="Nominal.Abs.Support.html#445" class="Bound">A</a><a id="694" class="Symbol">)</a>
    <a id="700" href="Nominal.Abs.Support.html#656" class="Function">FinSupp-Abs</a> <a id="712" class="Symbol">.</a><a id="713" href="Nominal.Support.html#1419" class="Field">∀fin</a> <a id="718" class="Symbol">(</a><a id="719" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="723" href="Nominal.Abs.Support.html#723" class="Bound">x</a> <a id="725" href="Nominal.Abs.Support.html#725" class="Bound">t</a><a id="726" class="Symbol">)</a> <a id="728" class="Symbol">=</a>
      <a id="736" class="Keyword">let</a> <a id="740" href="Nominal.Abs.Support.html#740" class="Bound">xs</a> <a id="743" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="745" href="Nominal.Abs.Support.html#745" class="Bound">p</a> <a id="747" class="Symbol">=</a> <a id="749" href="Nominal.Support.html#1419" class="Field">∀fin</a> <a id="754" href="Nominal.Abs.Support.html#725" class="Bound">t</a>
      <a id="762" class="Keyword">in</a> <a id="765" href="Nominal.Abs.Support.html#723" class="Bound">x</a> <a id="767" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="769" href="Nominal.Abs.Support.html#740" class="Bound">xs</a> <a id="772" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="774" class="Symbol">λ</a> <a id="776" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="778" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="780" href="Nominal.Abs.Support.html#780" class="Bound">y∉</a> <a id="783" href="Nominal.Abs.Support.html#783" class="Bound">z∉</a> <a id="786" class="Symbol">→</a>
      <a id="794" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
        <a id="808" href="Nominal.Swap.Base.html#620" class="Function Operator">⦅</a> <a id="810" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="812" href="Nominal.Swap.Base.html#620" class="Function Operator">↔</a> <a id="814" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="816" href="Nominal.Swap.Base.html#620" class="Function Operator">⦆</a> <a id="818" class="Symbol">(</a><a id="819" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="823" href="Nominal.Abs.Support.html#723" class="Bound">x</a> <a id="825" href="Nominal.Abs.Support.html#725" class="Bound">t</a><a id="826" class="Symbol">)</a>
      <a id="834" href="Relation.Binary.Reasoning.Base.Single.html#2479" class="Function Operator">≡⟨⟩</a>
        <a id="846" class="Comment">-- ⦅ 𝕒 ↔ 𝕓 ⦆ (f 𝕔) ≈ (⦅ 𝕒 ↔ 𝕓 ⦆ f) (⦅ 𝕒 ↔ 𝕓 ⦆ 𝕔)</a>
        <a id="903" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="907" class="Symbol">(</a><a id="908" href="Nominal.Swap.Base.html#620" class="Function Operator">⦅</a> <a id="910" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="912" href="Nominal.Swap.Base.html#620" class="Function Operator">↔</a> <a id="914" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="916" href="Nominal.Swap.Base.html#620" class="Function Operator">⦆</a> <a id="918" href="Nominal.Abs.Support.html#723" class="Bound">x</a><a id="919" class="Symbol">)</a> <a id="921" class="Symbol">(</a><a id="922" href="Nominal.Swap.Base.html#620" class="Function Operator">⦅</a> <a id="924" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="926" href="Nominal.Swap.Base.html#620" class="Function Operator">↔</a> <a id="928" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="930" href="Nominal.Swap.Base.html#620" class="Function Operator">⦆</a> <a id="932" href="Nominal.Abs.Support.html#725" class="Bound">t</a><a id="933" class="Symbol">)</a>
      <a id="941" href="Relation.Binary.Reasoning.Base.Single.html#2191" class="Function">≡⟨</a> <a id="944" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="949" class="Symbol">(λ</a> <a id="952" href="Nominal.Abs.Support.html#952" class="Bound">◆</a> <a id="954" class="Symbol">→</a> <a id="956" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="960" href="Nominal.Abs.Support.html#952" class="Bound">◆</a> <a id="962" class="Symbol">(</a><a id="963" href="Nominal.Swap.Base.html#620" class="Function Operator">⦅</a> <a id="965" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="967" href="Nominal.Swap.Base.html#620" class="Function Operator">↔</a> <a id="969" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="971" href="Nominal.Swap.Base.html#620" class="Function Operator">⦆</a> <a id="973" href="Nominal.Abs.Support.html#725" class="Bound">t</a><a id="974" class="Symbol">))</a>
            <a id="989" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="991" href="Nominal.Swap.Base.html#2229" class="Function">swap-noop</a> <a id="1001" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="1003" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="1005" href="Nominal.Abs.Support.html#723" class="Bound">x</a> <a id="1007" class="Symbol">(λ</a> <a id="1010" class="Keyword">where</a> <a id="1016" href="Nominal.Swap.Base.html#2455" class="InductiveConstructor">♯0</a> <a id="1019" class="Symbol">→</a> <a id="1021" href="Nominal.Abs.Support.html#783" class="Bound">z∉</a> <a id="1024" href="Nominal.Swap.Base.html#2455" class="InductiveConstructor">♯0</a><a id="1026" class="Symbol">;</a> <a id="1028" href="Nominal.Swap.Base.html#2478" class="InductiveConstructor">♯1</a> <a id="1031" class="Symbol">→</a> <a id="1033" href="Nominal.Abs.Support.html#780" class="Bound">y∉</a> <a id="1036" href="Nominal.Swap.Base.html#2455" class="InductiveConstructor">♯0</a><a id="1038" class="Symbol">)</a> <a id="1040" href="Relation.Binary.Reasoning.Base.Single.html#2191" class="Function">⟩</a>
        <a id="1050" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="1054" href="Nominal.Abs.Support.html#723" class="Bound">x</a> <a id="1056" class="Symbol">(</a><a id="1057" href="Nominal.Swap.Base.html#620" class="Function Operator">⦅</a> <a id="1059" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="1061" href="Nominal.Swap.Base.html#620" class="Function Operator">↔</a> <a id="1063" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="1065" href="Nominal.Swap.Base.html#620" class="Function Operator">⦆</a> <a id="1067" href="Nominal.Abs.Support.html#725" class="Bound">t</a><a id="1068" class="Symbol">)</a>
      <a id="1076" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="1079" href="Nominal.Abs.Base.html#2015" class="Function">cong-abs</a> <a id="1088" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1090" href="Nominal.Abs.Support.html#745" class="Bound">p</a> <a id="1092" href="Nominal.Abs.Support.html#776" class="Bound">y</a> <a id="1094" href="Nominal.Abs.Support.html#778" class="Bound">z</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Nominal.Abs.Support.html#780" class="Bound">y∉</a> <a id="1100" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1102" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a><a id="1107" class="Symbol">)</a> <a id="1109" class="Symbol">(</a><a id="1110" href="Nominal.Abs.Support.html#783" class="Bound">z∉</a> <a id="1113" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1115" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a><a id="1120" class="Symbol">)</a> <a id="1122" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
        <a id="1132" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="1136" href="Nominal.Abs.Support.html#723" class="Bound">x</a> <a id="1138" href="Nominal.Abs.Support.html#725" class="Bound">t</a>
      <a id="1146" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a> <a id="1148" class="Keyword">where</a> <a id="1154" class="Keyword">open</a> <a id="1159" href="Prelude.Setoid.Core.html#705" class="Module">≈-Reasoning</a>

  <a id="1174" class="Comment">-- Two ways to fix functoriality:</a>
    <a id="1212" class="Comment">-- 1. require that (f : A → A) is equivariant</a>
  <a id="1260" class="Comment">--   2. ...or that it at least has finite support</a>
  <a id="1312" href="Nominal.Abs.Support.html#1312" class="Function">mapAbs</a> <a id="1319" class="Symbol">:</a> <a id="1321" href="Algebra.Core.html#484" class="Function">Op₁</a> <a id="1325" href="Nominal.Abs.Support.html#445" class="Bound">A</a> <a id="1327" class="Symbol">→</a> <a id="1329" href="Algebra.Core.html#484" class="Function">Op₁</a> <a id="1333" class="Symbol">(</a><a id="1334" href="Nominal.Abs.Base.html#437" class="Record">Abs</a> <a id="1338" href="Nominal.Abs.Support.html#445" class="Bound">A</a><a id="1339" class="Symbol">)</a>
      <a id="1347" class="Comment">-- ≈ (A → A) → (Abs A → Abs A)</a>
  <a id="1380" class="Comment">-- T0D0: In order to resolve termination issues (via well-founded recursion),</a>
  <a id="1460" class="Comment">-- we need a more restrainted version of mapAbs with type:</a>
  <a id="1521" class="Comment">-- mapAbs : (x&#39; : Abs A) → (f : (a : A) → a ≺ f → A) → Abs A</a>
  <a id="1584" class="Comment">-- NB: a generalisation would be to say that the size behaviour of</a>
  <a id="1653" class="Comment">--     `mapAbs f` corresponds to that of `f`</a>
  <a id="1700" href="Nominal.Abs.Support.html#1312" class="Function">mapAbs</a> <a id="1707" href="Nominal.Abs.Support.html#1707" class="Bound">f</a> <a id="1709" href="Nominal.Abs.Support.html#1709" class="Bound">x&#39;</a> <a id="1712" class="Symbol">=</a>
    <a id="1718" class="Keyword">let</a> <a id="1722" href="Nominal.Abs.Support.html#1722" class="Bound">a</a> <a id="1724" class="Symbol">=</a> <a id="1726" href="Nominal.Support.html#2029" class="Function">fresh-var</a> <a id="1736" href="Nominal.Abs.Support.html#1709" class="Bound">x&#39;</a> <a id="1739" class="Comment">-- T0D0: ++ supp?? f</a>
    <a id="1764" class="Keyword">in</a> <a id="1767" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="1771" href="Nominal.Abs.Support.html#1722" class="Bound">a</a> <a id="1773" class="Symbol">(</a><a id="1774" href="Nominal.Abs.Support.html#1707" class="Bound">f</a> <a id="1776" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1778" href="Nominal.Abs.Base.html#587" class="Function">conc</a> <a id="1783" href="Nominal.Abs.Support.html#1709" class="Bound">x&#39;</a> <a id="1786" href="Nominal.Abs.Support.html#1722" class="Bound">a</a><a id="1787" class="Symbol">)</a>

  <a id="1792" href="Nominal.Abs.Support.html#1792" class="Function">freshen</a> <a id="1800" class="Symbol">:</a> <a id="1802" href="Algebra.Core.html#484" class="Function">Op₁</a> <a id="1806" class="Symbol">(</a><a id="1807" href="Nominal.Abs.Base.html#437" class="Record">Abs</a> <a id="1811" href="Nominal.Abs.Support.html#445" class="Bound">A</a><a id="1812" class="Symbol">)</a>
  <a id="1816" href="Nominal.Abs.Support.html#1792" class="Function">freshen</a> <a id="1824" href="Nominal.Abs.Support.html#1824" class="Bound">f</a><a id="1825" class="Symbol">@(</a><a id="1827" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="1831" href="Nominal.Abs.Support.html#1831" class="Bound">a</a> <a id="1833" href="Nominal.Abs.Support.html#1833" class="Bound">t</a><a id="1834" class="Symbol">)</a> <a id="1836" class="Symbol">=</a>
    <a id="1842" class="Keyword">let</a> <a id="1846" href="Nominal.Abs.Support.html#1846" class="Bound">xs</a> <a id="1849" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1851" class="Symbol">_</a> <a id="1853" class="Symbol">=</a> <a id="1855" href="Nominal.Support.html#1419" class="Field">∀fin</a> <a id="1860" href="Nominal.Abs.Support.html#1824" class="Bound">f</a>
        <a id="1870" href="Nominal.Abs.Support.html#1870" class="Bound">b</a> <a id="1872" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1874" href="Nominal.Abs.Support.html#1874" class="Bound">b∉</a> <a id="1877" class="Symbol">=</a> <a id="1879" href="Prelude.InfEnumerable.html#1923" class="Function">minFresh</a> <a id="1888" href="Nominal.Abs.Support.html#1846" class="Bound">xs</a>
    <a id="1895" class="Keyword">in</a> <a id="1898" href="Nominal.Abs.Base.html#483" class="InductiveConstructor">abs</a> <a id="1902" href="Nominal.Abs.Support.html#1870" class="Bound">b</a> <a id="1904" class="Symbol">(</a><a id="1905" href="Nominal.Abs.Base.html#587" class="Function">conc</a> <a id="1910" href="Nominal.Abs.Support.html#1824" class="Bound">f</a> <a id="1912" href="Nominal.Abs.Support.html#1870" class="Bound">b</a><a id="1913" class="Symbol">)</a>
</pre></body></html>