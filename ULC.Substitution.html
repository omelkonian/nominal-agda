<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ULC.Substitution</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/nominal-agda/tree/master/ULC/Substitution.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Comment">-- {-# OPTIONS --auto-inline #-}</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="98" class="Keyword">hiding</a> <a id="105" class="Symbol">(</a><a id="106" href="Data.List.Base.html#5034" class="Function Operator">[_]</a><a id="109" class="Symbol">);</a> <a id="112" class="Keyword">open</a> <a id="117" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="127" class="Keyword">open</a> <a id="132" href="Prelude.Init.html#7133" class="Module">L.Mem</a>
<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="166" class="Keyword">open</a> <a id="171" class="Keyword">import</a> <a id="178" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="192" class="Comment">-- open import Prelude.Lists.Dec</a>
<a id="225" class="Comment">-- open import Prelude.Measurable</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Prelude.InfEnumerable.html" class="Module">Prelude.InfEnumerable</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>

<a id="356" class="Comment">-- ** Substitution.</a>
<a id="376" class="Keyword">module</a> <a id="383" href="ULC.Substitution.html" class="Module">ULC.Substitution</a> <a id="400" class="Symbol">(</a><a id="401" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="406" class="Symbol">:</a> <a id="408" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="412" class="Symbol">)</a> <a id="414" class="Symbol">⦃</a> <a id="416" href="ULC.Substitution.html#416" class="Bound">_</a> <a id="418" class="Symbol">:</a> <a id="420" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="426" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="431" class="Symbol">⦄</a> <a id="433" class="Symbol">⦃</a> <a id="435" href="ULC.Substitution.html#435" class="Bound">_</a> <a id="437" class="Symbol">:</a> <a id="439" href="Prelude.InfEnumerable.html#663" class="Record">Enumerable∞</a> <a id="451" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="456" class="Symbol">⦄</a> <a id="458" class="Keyword">where</a>

<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="ULC.Base.html" class="Module">ULC.Base</a>    <a id="489" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="494" class="Symbol">⦃</a> <a id="496" href="Function.Base.html#4821" class="Function">it</a> <a id="499" class="Symbol">⦄</a>
<a id="501" class="Keyword">open</a> <a id="506" class="Keyword">import</a> <a id="513" href="ULC.Measure.html" class="Module">ULC.Measure</a> <a id="525" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="530" class="Symbol">⦃</a> <a id="532" href="Function.Base.html#4821" class="Function">it</a> <a id="535" class="Symbol">⦄</a> <a id="537" class="Symbol">⦃</a> <a id="539" href="Function.Base.html#4821" class="Function">it</a> <a id="542" class="Symbol">⦄</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="ULC.Alpha.html" class="Module">ULC.Alpha</a>   <a id="568" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="573" class="Symbol">⦃</a> <a id="575" href="Function.Base.html#4821" class="Function">it</a> <a id="578" class="Symbol">⦄</a> <a id="580" class="Symbol">⦃</a> <a id="582" href="Function.Base.html#4821" class="Function">it</a> <a id="585" class="Symbol">⦄</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="Nominal.html" class="Module">Nominal</a> <a id="607" href="ULC.Substitution.html#401" class="Bound">Atom</a>
<a id="612" class="Keyword">open</a> <a id="617" class="Keyword">import</a> <a id="624" href="Nominal.Product.html" class="Module">Nominal.Product</a> <a id="640" href="ULC.Substitution.html#401" class="Bound">Atom</a>

<a id="646" class="Comment">-- enforce the Barendregt convention: no shadowing, distinct bound variables</a>
<a id="723" class="Symbol">{-#</a> <a id="727" class="Keyword">TERMINATING</a> <a id="739" class="Symbol">#-}</a>
<a id="barendregt"></a><a id="743" href="ULC.Substitution.html#743" class="Function">barendregt</a> <a id="754" class="Symbol">:</a> <a id="756" href="Algebra.Core.html#484" class="Function">Op₁</a> <a id="760" href="ULC.Base.html#356" class="Datatype">Term</a>
<a id="765" href="ULC.Substitution.html#743" class="Function">barendregt</a> <a id="776" class="Symbol">=</a> <a id="778" href="ULC.Substitution.html#796" class="Function">go</a> <a id="781" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
  <a id="786" class="Keyword">where</a>
    <a id="796" href="ULC.Substitution.html#796" class="Function">go</a> <a id="799" class="Symbol">:</a> <a id="801" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="806" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="811" class="Symbol">→</a> <a id="813" href="Algebra.Core.html#484" class="Function">Op₁</a> <a id="817" href="ULC.Base.html#356" class="Datatype">Term</a>
    <a id="826" href="ULC.Substitution.html#796" class="Function">go</a> <a id="829" href="ULC.Substitution.html#829" class="Bound">xs</a> <a id="832" class="Symbol">=</a> <a id="834" class="Symbol">λ</a> <a id="836" class="Keyword">where</a>
      <a id="848" class="Symbol">(</a><a id="849" href="ULC.Base.html#376" class="InductiveConstructor Operator">`</a> <a id="851" href="ULC.Substitution.html#851" class="Bound">x</a><a id="852" class="Symbol">)</a>     <a id="858" class="Symbol">→</a> <a id="860" href="ULC.Base.html#376" class="InductiveConstructor Operator">`</a> <a id="862" href="ULC.Substitution.html#851" class="Bound">x</a>
      <a id="870" class="Symbol">(</a><a id="871" href="ULC.Substitution.html#871" class="Bound">l</a> <a id="873" href="ULC.Base.html#396" class="InductiveConstructor Operator">·</a> <a id="875" href="ULC.Substitution.html#875" class="Bound">r</a><a id="876" class="Symbol">)</a>   <a id="880" class="Symbol">→</a> <a id="882" href="ULC.Substitution.html#796" class="Function">go</a> <a id="885" href="ULC.Substitution.html#829" class="Bound">xs</a> <a id="888" href="ULC.Substitution.html#871" class="Bound">l</a> <a id="890" href="ULC.Base.html#396" class="InductiveConstructor Operator">·</a> <a id="892" href="ULC.Substitution.html#796" class="Function">go</a> <a id="895" href="ULC.Substitution.html#829" class="Bound">xs</a> <a id="898" href="ULC.Substitution.html#875" class="Bound">r</a>
      <a id="906" class="Symbol">(</a><a id="907" href="ULC.Base.html#581" class="InductiveConstructor Operator">ƛ</a> <a id="909" href="ULC.Substitution.html#909" class="Bound">x</a> <a id="911" href="ULC.Base.html#581" class="InductiveConstructor Operator">⇒</a> <a id="913" href="ULC.Substitution.html#913" class="Bound">t</a><a id="914" class="Symbol">)</a> <a id="916" class="Symbol">→</a> <a id="918" class="Keyword">let</a> <a id="922" href="ULC.Substitution.html#922" class="Bound">x′</a> <a id="925" class="Symbol">=</a> <a id="927" href="Nominal.Support.html#325" class="Function">freshAtom</a> <a id="937" class="Symbol">(</a><a id="938" href="ULC.Substitution.html#829" class="Bound">xs</a> <a id="941" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="944" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="949" href="ULC.Substitution.html#913" class="Bound">t</a><a id="950" class="Symbol">)</a>
                  <a id="970" class="Keyword">in</a> <a id="973" href="ULC.Base.html#581" class="InductiveConstructor Operator">ƛ</a> <a id="975" href="ULC.Substitution.html#922" class="Bound">x′</a> <a id="978" href="ULC.Base.html#581" class="InductiveConstructor Operator">⇒</a> <a id="980" href="ULC.Substitution.html#796" class="Function">go</a> <a id="983" class="Symbol">(</a><a id="984" href="ULC.Substitution.html#909" class="Bound">x</a> <a id="986" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="988" href="ULC.Substitution.html#829" class="Bound">xs</a><a id="990" class="Symbol">)</a> <a id="992" class="Symbol">(</a><a id="993" href="Nominal.Swap.Base.html#442" class="Field">swap</a> <a id="998" href="ULC.Substitution.html#922" class="Bound">x′</a> <a id="1001" href="ULC.Substitution.html#909" class="Bound">x</a> <a id="1003" href="ULC.Substitution.html#913" class="Bound">t</a><a id="1004" class="Symbol">)</a>

<a id="1007" class="Keyword">infix</a> <a id="1013" class="Number">6</a> <a id="1015" href="ULC.Substitution.html#1042" class="Function Operator">_[_/_]</a>
<a id="1022" class="Symbol">{-#</a> <a id="1026" class="Keyword">TERMINATING</a> <a id="1038" class="Symbol">#-}</a>
<a id="_[_/_]"></a><a id="1042" href="ULC.Substitution.html#1042" class="Function Operator">_[_/_]</a> <a id="1049" class="Symbol">:</a> <a id="1051" href="ULC.Base.html#356" class="Datatype">Term</a> <a id="1056" class="Symbol">→</a> <a id="1058" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="ULC.Base.html#356" class="Datatype">Term</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="ULC.Base.html#356" class="Datatype">Term</a>
<a id="1077" class="Symbol">(</a><a id="1078" href="ULC.Base.html#376" class="InductiveConstructor Operator">`</a> <a id="1080" href="ULC.Substitution.html#1080" class="Bound">x</a><a id="1081" class="Symbol">)</a> <a id="1083" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1085" href="ULC.Substitution.html#1085" class="Bound">𝕒</a> <a id="1087" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1089" href="ULC.Substitution.html#1089" class="Bound">N</a> <a id="1091" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="1093" class="Symbol">=</a> <a id="1095" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="1098" href="ULC.Substitution.html#1080" class="Bound">x</a> <a id="1100" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="1103" href="ULC.Substitution.html#1085" class="Bound">𝕒</a> <a id="1105" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="1110" href="ULC.Substitution.html#1089" class="Bound">N</a> <a id="1112" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="1117" href="ULC.Base.html#376" class="InductiveConstructor Operator">`</a> <a id="1119" href="ULC.Substitution.html#1080" class="Bound">x</a>
<a id="1121" class="Symbol">(</a><a id="1122" href="ULC.Substitution.html#1122" class="Bound">L</a> <a id="1124" href="ULC.Base.html#396" class="InductiveConstructor Operator">·</a> <a id="1126" href="ULC.Substitution.html#1126" class="Bound">M</a><a id="1127" class="Symbol">)</a> <a id="1129" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1131" href="ULC.Substitution.html#1131" class="Bound">𝕒</a> <a id="1133" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1135" href="ULC.Substitution.html#1135" class="Bound">N</a> <a id="1137" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="1139" class="Symbol">=</a>
  <a id="1143" class="Keyword">let</a> <a id="1147" href="ULC.Substitution.html#1147" class="Bound">L′</a> <a id="1150" class="Symbol">=</a> <a id="1152" href="ULC.Substitution.html#1122" class="Bound">L</a> <a id="1154" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1156" href="ULC.Substitution.html#1131" class="Bound">𝕒</a> <a id="1158" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1160" href="ULC.Substitution.html#1135" class="Bound">N</a> <a id="1162" href="ULC.Substitution.html#1042" class="Function Operator">]</a>
      <a id="1170" href="ULC.Substitution.html#1170" class="Bound">M′</a> <a id="1173" class="Symbol">=</a> <a id="1175" href="ULC.Substitution.html#1126" class="Bound">M</a> <a id="1177" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1179" href="ULC.Substitution.html#1131" class="Bound">𝕒</a> <a id="1181" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1183" href="ULC.Substitution.html#1135" class="Bound">N</a> <a id="1185" href="ULC.Substitution.html#1042" class="Function Operator">]</a>
  <a id="1189" class="Keyword">in</a> <a id="1192" href="ULC.Substitution.html#1147" class="Bound">L′</a> <a id="1195" href="ULC.Base.html#396" class="InductiveConstructor Operator">·</a> <a id="1197" href="ULC.Substitution.html#1170" class="Bound">M′</a>
<a id="1200" class="Symbol">(</a><a id="1201" href="ULC.Base.html#413" class="InductiveConstructor Operator">ƛ</a> <a id="1203" href="ULC.Substitution.html#1203" class="Bound">t̂</a><a id="1205" class="Symbol">)</a> <a id="1207" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1209" href="ULC.Substitution.html#1209" class="Bound">𝕒</a> <a id="1211" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1213" href="ULC.Substitution.html#1213" class="Bound">N</a> <a id="1215" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="1217" class="Symbol">=</a>
  <a id="1221" class="Comment">-- let y = fresh-var (𝕒 , t̂ , N)</a>
  <a id="1257" class="Keyword">let</a> <a id="1261" href="ULC.Substitution.html#1261" class="Bound">y</a> <a id="1263" class="Symbol">=</a> <a id="1265" href="Nominal.Support.html#325" class="Function">freshAtom</a> <a id="1275" class="Symbol">(</a><a id="1276" href="ULC.Substitution.html#1209" class="Bound">𝕒</a> <a id="1278" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1280" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="1285" href="ULC.Substitution.html#1203" class="Bound">t̂</a> <a id="1288" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="1291" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="1296" href="ULC.Substitution.html#1213" class="Bound">N</a><a id="1297" class="Symbol">)</a>
  <a id="1301" class="Keyword">in</a> <a id="1304" href="ULC.Base.html#581" class="InductiveConstructor Operator">ƛ</a> <a id="1306" href="ULC.Substitution.html#1261" class="Bound">y</a> <a id="1308" href="ULC.Base.html#581" class="InductiveConstructor Operator">⇒</a> <a id="1310" href="Nominal.Abs.Base.html#554" class="Function">conc</a> <a id="1315" href="ULC.Substitution.html#1203" class="Bound">t̂</a> <a id="1318" href="ULC.Substitution.html#1261" class="Bound">y</a> <a id="1320" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1322" href="ULC.Substitution.html#1209" class="Bound">𝕒</a> <a id="1324" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1326" href="ULC.Substitution.html#1213" class="Bound">N</a> <a id="1328" href="ULC.Substitution.html#1042" class="Function Operator">]</a>

<a id="1331" class="Keyword">infix</a> <a id="1337" class="Number">6</a> <a id="1339" href="ULC.Substitution.html#1344" class="Function Operator">_[_]</a>
<a id="_[_]"></a><a id="1344" href="ULC.Substitution.html#1344" class="Function Operator">_[_]</a> <a id="1349" class="Symbol">:</a> <a id="1351" href="Nominal.Abs.Base.html#404" class="Record">Abs</a> <a id="1355" href="ULC.Base.html#356" class="Datatype">Term</a> <a id="1360" class="Symbol">→</a> <a id="1362" href="ULC.Base.html#356" class="Datatype">Term</a> <a id="1367" class="Symbol">→</a> <a id="1369" href="ULC.Base.html#356" class="Datatype">Term</a>
<a id="1374" class="Symbol">(</a><a id="1375" href="Nominal.Abs.Base.html#450" class="InductiveConstructor">abs</a> <a id="1379" href="ULC.Substitution.html#1379" class="Bound">x</a> <a id="1381" href="ULC.Substitution.html#1381" class="Bound">t</a><a id="1382" class="Symbol">)</a> <a id="1384" href="ULC.Substitution.html#1344" class="Function Operator">[</a> <a id="1386" href="ULC.Substitution.html#1386" class="Bound">s</a> <a id="1388" href="ULC.Substitution.html#1344" class="Function Operator">]</a> <a id="1390" class="Symbol">=</a> <a id="1392" class="Symbol">(</a><a id="1393" href="ULC.Base.html#581" class="InductiveConstructor Operator">ƛ</a> <a id="1395" href="ULC.Substitution.html#1379" class="Bound">x</a> <a id="1397" href="ULC.Base.html#581" class="InductiveConstructor Operator">⇒</a> <a id="1399" href="ULC.Substitution.html#1381" class="Bound">t</a><a id="1400" class="Symbol">)</a> <a id="1402" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1404" href="ULC.Substitution.html#1379" class="Bound">x</a> <a id="1406" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1408" href="ULC.Substitution.html#1386" class="Bound">s</a> <a id="1410" href="ULC.Substitution.html#1042" class="Function Operator">]</a>

<a id="1413" class="Keyword">infix</a> <a id="1419" class="Number">6</a> <a id="1421" href="ULC.Substitution.html#1429" class="Function Operator">_[_/_]↑</a>
<a id="_[_/_]↑"></a><a id="1429" href="ULC.Substitution.html#1429" class="Function Operator">_[_/_]↑</a> <a id="1437" class="Symbol">:</a> <a id="1439" href="Nominal.Abs.Base.html#404" class="Record">Abs</a> <a id="1443" href="ULC.Base.html#356" class="Datatype">Term</a> <a id="1448" class="Symbol">→</a> <a id="1450" href="ULC.Substitution.html#401" class="Bound">Atom</a> <a id="1455" class="Symbol">→</a> <a id="1457" href="ULC.Base.html#356" class="Datatype">Term</a> <a id="1462" class="Symbol">→</a> <a id="1464" href="Nominal.Abs.Base.html#404" class="Record">Abs</a> <a id="1468" href="ULC.Base.html#356" class="Datatype">Term</a>
<a id="1473" class="Symbol">(</a><a id="1474" href="Nominal.Abs.Base.html#450" class="InductiveConstructor">abs</a> <a id="1478" href="ULC.Substitution.html#1478" class="Bound">𝕒</a> <a id="1480" href="ULC.Substitution.html#1480" class="Bound">t</a><a id="1481" class="Symbol">)</a> <a id="1483" href="ULC.Substitution.html#1429" class="Function Operator">[</a> <a id="1485" href="ULC.Substitution.html#1485" class="Bound">x</a> <a id="1487" href="ULC.Substitution.html#1429" class="Function Operator">/</a> <a id="1489" href="ULC.Substitution.html#1489" class="Bound">N</a> <a id="1491" href="ULC.Substitution.html#1429" class="Function Operator">]↑</a> <a id="1494" class="Symbol">=</a> <a id="1496" href="ULC.Base.html#1365" class="Function">unƛ</a> <a id="1500" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1502" class="Symbol">(</a><a id="1503" href="ULC.Base.html#581" class="InductiveConstructor Operator">ƛ</a> <a id="1505" href="ULC.Substitution.html#1478" class="Bound">𝕒</a> <a id="1507" href="ULC.Base.html#581" class="InductiveConstructor Operator">⇒</a> <a id="1509" href="ULC.Substitution.html#1480" class="Bound">t</a><a id="1510" class="Symbol">)</a> <a id="1512" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="1514" href="ULC.Substitution.html#1485" class="Bound">x</a> <a id="1516" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="1518" href="ULC.Substitution.html#1489" class="Bound">N</a> <a id="1520" href="ULC.Substitution.html#1042" class="Function Operator">]</a>

<a id="1523" class="Comment">{- ** well-founded version
t₀ [ 𝕒 / s ] = ≺-rec _ go t₀
  module ∣Substitution∣ where
    go : ∀ x → (∀ y → y ≺ x → Term) → Term
    go x rec with x
    ... | ` x   = if x == 𝕒 then s else ` x
    ... | l · m = rec l (l ·≺ˡ m) · rec m (l ·≺ʳ m)
    -- Cannot simply use `ƛ (mapAbs go f)` here; need well-founded recursion
    -- ... | ƛ f   = ƛ mapAbs-Term f (λ t t≺ → rec t t≺)
    ... | ƛ f =
      let y , _ = fresh (nub $ 𝕒 ∷ supp f ++ supp s)
      in  ƛ y ⇒ rec (conc f y) (conc≺ f y)
-}</a>

<a id="2018" class="Comment">-- ** postulate equivariance of substitution for now...</a>
<a id="2074" class="Keyword">postulate</a> <a id="swap-subst"></a><a id="2084" href="ULC.Substitution.html#2084" class="Postulate">swap-subst</a> <a id="2095" class="Symbol">:</a> <a id="2097" href="Nominal.Swap.Equivariance.html#3245" class="Macro">Equivariant</a> <a id="2109" href="ULC.Substitution.html#1042" class="Function Operator">_[_/_]</a>
<a id="2116" class="Comment">-- swap-subst = ? -- equivariant _[_/_]</a>

<a id="2157" class="Comment">-- ** we will also need the following lemmas for proving Reduction.sub-par (β case)</a>

<a id="subst-commute"></a><a id="2242" href="ULC.Substitution.html#2242" class="Function">subst-commute</a> <a id="2256" class="Symbol">:</a> <a id="2258" href="ULC.Base.html#669" class="Generalizable">N</a> <a id="2260" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2262" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="2264" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2266" href="ULC.Base.html#659" class="Generalizable">L</a> <a id="2268" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="2270" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2272" href="ULC.Base.html#616" class="Generalizable">y</a> <a id="2274" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2276" href="ULC.Base.html#664" class="Generalizable">M</a> <a id="2278" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2280" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="2282" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2284" href="ULC.Base.html#659" class="Generalizable">L</a> <a id="2286" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="2288" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="2290" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="2292" href="ULC.Base.html#669" class="Generalizable">N</a> <a id="2294" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2296" href="ULC.Base.html#616" class="Generalizable">y</a> <a id="2298" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2300" href="ULC.Base.html#664" class="Generalizable">M</a> <a id="2302" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="2304" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2306" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="2308" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2310" href="ULC.Base.html#659" class="Generalizable">L</a> <a id="2312" href="ULC.Substitution.html#1042" class="Function Operator">]</a>
<a id="2314" href="ULC.Substitution.html#2242" class="Function">subst-commute</a> <a id="2328" class="Symbol">{</a><a id="2329" href="ULC.Base.html#376" class="InductiveConstructor Operator">`</a> <a id="2331" href="ULC.Substitution.html#2331" class="Bound">n</a><a id="2332" class="Symbol">}</a> <a id="2334" class="Symbol">{</a><a id="2335" href="ULC.Substitution.html#2335" class="Bound">x</a><a id="2336" class="Symbol">}</a> <a id="2338" class="Symbol">{</a><a id="2339" href="ULC.Substitution.html#2339" class="Bound">L</a><a id="2340" class="Symbol">}</a> <a id="2342" class="Symbol">{</a><a id="2343" href="ULC.Substitution.html#2343" class="Bound">y</a><a id="2344" class="Symbol">}</a> <a id="2346" class="Symbol">{</a><a id="2347" href="ULC.Substitution.html#2347" class="Bound">M</a><a id="2348" class="Symbol">}</a>
  <a id="2352" class="Keyword">with</a> <a id="2357" href="ULC.Substitution.html#2331" class="Bound">n</a> <a id="2359" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="2361" href="ULC.Substitution.html#2335" class="Bound">x</a> <a id="2363" class="Symbol">|</a> <a id="2365" href="ULC.Substitution.html#2331" class="Bound">n</a> <a id="2367" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="2369" href="ULC.Substitution.html#2343" class="Bound">y</a>
<a id="2371" class="Symbol">...</a> <a id="2375" class="Symbol">|</a> <a id="2377" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="2381" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2386" class="Symbol">|</a> <a id="2388" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="2392" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="2399" class="Comment">-- exclude with x ≠ y</a>
  <a id="2423" class="Symbol">=</a> <a id="2425" class="Hole">{!subst-commute !}</a>
<a id="2444" class="Symbol">...</a> <a id="2448" class="Symbol">|</a> <a id="2450" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="2454" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2459" class="Symbol">|</a> <a id="2461" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2464" href="ULC.Substitution.html#2464" class="Bound">n≠y</a>
  <a id="2470" class="Keyword">rewrite</a> <a id="2478" href="Prelude.DecEq.WithK.html#170" class="Function">≟-refl</a> <a id="2485" class="Bound">n</a>
  <a id="2489" class="Symbol">=</a> <a id="2491" class="Hole">{!!}</a>
  <a id="2498" class="Comment">-- prove with y ♯ L</a>
<a id="2518" class="Symbol">...</a> <a id="2522" class="Symbol">|</a> <a id="2524" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2527" href="ULC.Substitution.html#2527" class="Bound">n≠x</a> <a id="2531" class="Symbol">|</a> <a id="2533" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="2537" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="2544" class="Keyword">rewrite</a> <a id="2552" href="Prelude.DecEq.WithK.html#170" class="Function">≟-refl</a> <a id="2559" class="Bound">n</a>
  <a id="2563" class="Symbol">=</a> <a id="2565" href="Prelude.Setoid.Core.html#470" class="Function">≈-refl</a>
<a id="2572" class="Symbol">...</a> <a id="2576" class="Symbol">|</a> <a id="2578" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2581" href="ULC.Substitution.html#2581" class="Bound">n≠x</a> <a id="2585" class="Symbol">|</a> <a id="2587" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2590" href="ULC.Substitution.html#2590" class="Bound">n≠y</a>
  <a id="2596" class="Keyword">rewrite</a> <a id="2604" href="Relation.Nullary.Decidable.Core.html#3296" class="Function">dec-no</a> <a id="2611" class="Symbol">(</a><a id="2612" class="Bound">n</a> <a id="2614" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="2616" class="Bound">x</a><a id="2617" class="Symbol">)</a> <a id="2619" href="ULC.Substitution.html#2581" class="Bound">n≠x</a> <a id="2623" class="Symbol">.</a><a id="2624" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
        <a id="2638" class="Symbol">|</a> <a id="2640" href="Relation.Nullary.Decidable.Core.html#3296" class="Function">dec-no</a> <a id="2647" class="Symbol">(</a><a id="2648" class="Bound">n</a> <a id="2650" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="2652" class="Bound">y</a><a id="2653" class="Symbol">)</a> <a id="2655" href="ULC.Substitution.html#2590" class="Bound">n≠y</a> <a id="2659" class="Symbol">.</a><a id="2660" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
        <a id="2674" class="Symbol">=</a> <a id="2676" href="Prelude.Setoid.Core.html#470" class="Function">≈-refl</a>
<a id="2683" href="ULC.Substitution.html#2242" class="Function">subst-commute</a> <a id="2697" class="Symbol">{</a><a id="2698" href="ULC.Substitution.html#2698" class="Bound">Nˡ</a> <a id="2701" href="ULC.Base.html#396" class="InductiveConstructor Operator">·</a> <a id="2703" href="ULC.Substitution.html#2703" class="Bound">Nʳ</a><a id="2705" class="Symbol">}</a> <a id="2707" class="Symbol">{</a><a id="2708" href="ULC.Substitution.html#2708" class="Bound">x</a><a id="2709" class="Symbol">}</a> <a id="2711" class="Symbol">{</a><a id="2712" href="ULC.Substitution.html#2712" class="Bound">L</a><a id="2713" class="Symbol">}</a> <a id="2715" class="Symbol">{</a><a id="2716" href="ULC.Substitution.html#2716" class="Bound">y</a><a id="2717" class="Symbol">}</a> <a id="2719" class="Symbol">{</a><a id="2720" href="ULC.Substitution.html#2720" class="Bound">M</a><a id="2721" class="Symbol">}</a>
  <a id="2725" class="Symbol">=</a> <a id="2727" href="ULC.Alpha.html#777" class="InductiveConstructor">ξ≡</a> <a id="2730" class="Symbol">(</a><a id="2731" href="ULC.Substitution.html#2242" class="Function">subst-commute</a> <a id="2745" class="Symbol">{</a><a id="2746" href="ULC.Substitution.html#2698" class="Bound">Nˡ</a><a id="2748" class="Symbol">})</a> <a id="2751" class="Symbol">(</a><a id="2752" href="ULC.Substitution.html#2242" class="Function">subst-commute</a> <a id="2766" class="Symbol">{</a><a id="2767" href="ULC.Substitution.html#2703" class="Bound">Nʳ</a><a id="2769" class="Symbol">})</a>
<a id="2772" href="ULC.Substitution.html#2242" class="Function">subst-commute</a> <a id="2786" class="Symbol">{</a><a id="2787" href="ULC.Base.html#413" class="InductiveConstructor Operator">ƛ</a> <a id="2789" href="ULC.Substitution.html#2789" class="Bound">t̂</a><a id="2791" class="Symbol">}</a> <a id="2793" class="Symbol">{</a><a id="2794" href="ULC.Substitution.html#2794" class="Bound">x</a><a id="2795" class="Symbol">}</a> <a id="2797" class="Symbol">{</a><a id="2798" href="ULC.Substitution.html#2798" class="Bound">L</a><a id="2799" class="Symbol">}</a> <a id="2801" class="Symbol">{</a><a id="2802" href="ULC.Substitution.html#2802" class="Bound">y</a><a id="2803" class="Symbol">}</a> <a id="2805" class="Symbol">{</a><a id="2806" href="ULC.Substitution.html#2806" class="Bound">M</a><a id="2807" class="Symbol">}</a>
  <a id="2811" class="Keyword">with</a> <a id="2816" href="ULC.Substitution.html#2816" class="Bound">xˡ</a> ← <a id="2821" href="Nominal.Support.html#325" class="Function">freshAtom</a> <a id="2831" class="Symbol">(</a><a id="2832" href="ULC.Substitution.html#2794" class="Bound">x</a> <a id="2834" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2836" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="2841" href="ULC.Substitution.html#2789" class="Bound">t̂</a> <a id="2844" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2847" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="2852" href="ULC.Substitution.html#2798" class="Bound">L</a><a id="2853" class="Symbol">)</a>
  <a id="2857" class="Comment">-- (ƛ xˡ ⇒ conc t̂ xˡ [ x / L ]) [ y / M [ x / L ] ]</a>
  <a id="2912" class="Keyword">with</a> <a id="2917" href="ULC.Substitution.html#2917" class="Bound">yˡ</a> ← <a id="2922" href="Nominal.Support.html#325" class="Function">freshAtom</a> <a id="2932" class="Symbol">(</a><a id="2933" href="ULC.Substitution.html#2802" class="Bound">y</a> <a id="2935" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2937" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="2942" class="Symbol">(</a><a id="2943" href="Nominal.Abs.Base.html#450" class="InductiveConstructor">abs</a> <a id="2947" href="ULC.Substitution.html#2816" class="Bound">xˡ</a> <a id="2950" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2952" href="Nominal.Abs.Base.html#554" class="Function">conc</a> <a id="2957" href="ULC.Substitution.html#2789" class="Bound">t̂</a> <a id="2960" href="ULC.Substitution.html#2816" class="Bound">xˡ</a> <a id="2963" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2965" href="ULC.Substitution.html#2794" class="Bound">x</a> <a id="2967" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2969" href="ULC.Substitution.html#2798" class="Bound">L</a> <a id="2971" href="ULC.Substitution.html#1042" class="Function Operator">]</a><a id="2972" class="Symbol">)</a> <a id="2974" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2977" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="2982" class="Symbol">(</a><a id="2983" href="ULC.Substitution.html#2806" class="Bound">M</a> <a id="2985" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="2987" href="ULC.Substitution.html#2794" class="Bound">x</a> <a id="2989" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="2991" href="ULC.Substitution.html#2798" class="Bound">L</a> <a id="2993" href="ULC.Substitution.html#1042" class="Function Operator">]</a><a id="2994" class="Symbol">))</a>
  <a id="2999" class="Comment">-- ƛ yˡ ⇒ conc (abs xˡ $ conc t̂ xˡ [ x / L ]) yˡ [ y / M [ x / L ] ]</a>
  <a id="3071" class="Comment">--      ≡ conc t̂ yˡ [ x / L ] [ y / M [ x / L ] ]</a>

  <a id="3125" class="Keyword">with</a> <a id="3130" href="ULC.Substitution.html#3130" class="Bound">yʳ</a> ← <a id="3135" href="Nominal.Support.html#325" class="Function">freshAtom</a> <a id="3145" class="Symbol">(</a><a id="3146" href="ULC.Substitution.html#2802" class="Bound">y</a> <a id="3148" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3150" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="3155" href="ULC.Substitution.html#2789" class="Bound">t̂</a> <a id="3158" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="3161" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="3166" href="ULC.Substitution.html#2806" class="Bound">M</a><a id="3167" class="Symbol">)</a>
  <a id="3171" class="Comment">-- (ƛ yʳ ⇒ conc t̂ yʳ [ y / M ]) [ x / L ]</a>
  <a id="3216" class="Keyword">with</a> <a id="3221" href="ULC.Substitution.html#3221" class="Bound">xʳ</a> ← <a id="3226" href="Nominal.Support.html#325" class="Function">freshAtom</a> <a id="3236" class="Symbol">(</a><a id="3237" href="ULC.Substitution.html#2794" class="Bound">x</a> <a id="3239" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3241" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="3246" class="Symbol">(</a><a id="3247" href="Nominal.Abs.Base.html#450" class="InductiveConstructor">abs</a> <a id="3251" href="ULC.Substitution.html#3130" class="Bound">yʳ</a> <a id="3254" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3256" href="Nominal.Abs.Base.html#554" class="Function">conc</a> <a id="3261" href="ULC.Substitution.html#2789" class="Bound">t̂</a> <a id="3264" href="ULC.Substitution.html#3130" class="Bound">yʳ</a> <a id="3267" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="3269" href="ULC.Substitution.html#2802" class="Bound">y</a> <a id="3271" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="3273" href="ULC.Substitution.html#2806" class="Bound">M</a> <a id="3275" href="ULC.Substitution.html#1042" class="Function Operator">]</a><a id="3276" class="Symbol">)</a> <a id="3278" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="3281" href="Nominal.Support.html#3495" class="Function">supp</a> <a id="3286" href="ULC.Substitution.html#2798" class="Bound">L</a><a id="3287" class="Symbol">)</a>
  <a id="3291" class="Comment">-- ƛ xʳ ⇒ conc (abs yʳ $ conc t̂ yʳ [ y / M ]) xʳ [ x / L ]</a>
  <a id="3353" class="Comment">--      ≡ conc t̂ xʳ [ y / M ] [ x / L ]</a>
  <a id="3396" class="Symbol">=</a> <a id="3398" href="ULC.Alpha.html#867" class="InductiveConstructor Operator">ζ≡</a> <a id="3401" class="Symbol">(</a><a id="3402" class="Hole">{!!}</a> <a id="3407" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3409" class="Symbol">(λ</a> <a id="3412" href="ULC.Substitution.html#3412" class="Bound">z</a> <a id="3414" href="ULC.Substitution.html#3414" class="Bound">z∉</a> <a id="3417" class="Symbol">→</a> <a id="3419" class="Hole">{!!}</a><a id="3423" class="Symbol">))</a>

<a id="3427" class="Keyword">postulate</a> <a id="cong-subst"></a><a id="3437" href="ULC.Substitution.html#3437" class="Postulate">cong-subst</a> <a id="3448" class="Symbol">:</a> <a id="3450" href="ULC.Base.html#651" class="Generalizable">t</a> <a id="3452" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="3454" href="ULC.Base.html#653" class="Generalizable">t′</a> <a id="3457" class="Symbol">→</a> <a id="3459" href="ULC.Base.html#651" class="Generalizable">t</a> <a id="3461" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="3463" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="3465" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="3467" href="ULC.Base.html#664" class="Generalizable">M</a> <a id="3469" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="3471" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="3473" href="ULC.Base.html#653" class="Generalizable">t′</a> <a id="3476" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="3478" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="3480" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="3482" href="ULC.Base.html#664" class="Generalizable">M</a> <a id="3484" href="ULC.Substitution.html#1042" class="Function Operator">]</a>

<a id="3487" class="Comment">-- {-# TERMINATING #-}</a>
<a id="swap∘subst"></a><a id="3510" href="ULC.Substitution.html#3510" class="Function">swap∘subst</a> <a id="3521" class="Symbol">:</a> <a id="3523" href="Nominal.Swap.Base.html#442" class="Field">swap</a> <a id="3528" href="ULC.Base.html#616" class="Generalizable">y</a> <a id="3530" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="3532" href="ULC.Base.html#669" class="Generalizable">N</a> <a id="3534" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="3536" href="ULC.Base.html#616" class="Generalizable">y</a> <a id="3538" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="3540" href="ULC.Base.html#664" class="Generalizable">M</a> <a id="3542" href="ULC.Substitution.html#1042" class="Function Operator">]</a> <a id="3544" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="3546" href="ULC.Base.html#669" class="Generalizable">N</a> <a id="3548" href="ULC.Substitution.html#1042" class="Function Operator">[</a> <a id="3550" href="ULC.Base.html#614" class="Generalizable">x</a> <a id="3552" href="ULC.Substitution.html#1042" class="Function Operator">/</a> <a id="3554" href="ULC.Base.html#664" class="Generalizable">M</a> <a id="3556" href="ULC.Substitution.html#1042" class="Function Operator">]</a>
<a id="3558" href="ULC.Substitution.html#3510" class="Function">swap∘subst</a> <a id="3569" class="Symbol">{</a><a id="3570" href="ULC.Substitution.html#3570" class="Bound">y</a><a id="3571" class="Symbol">}</a> <a id="3573" class="Symbol">{</a><a id="3574" href="ULC.Substitution.html#3574" class="Bound">x</a><a id="3575" class="Symbol">}</a> <a id="3577" class="Symbol">{</a><a id="3578" href="ULC.Base.html#376" class="InductiveConstructor Operator">`</a> <a id="3580" href="ULC.Substitution.html#3580" class="Bound">n</a><a id="3581" class="Symbol">}</a> <a id="3583" class="Symbol">{</a><a id="3584" href="ULC.Substitution.html#3584" class="Bound">M</a><a id="3585" class="Symbol">}</a>
  <a id="3589" class="Keyword">with</a> <a id="3594" href="ULC.Substitution.html#3580" class="Bound">n</a> <a id="3596" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3598" href="ULC.Substitution.html#3574" class="Bound">x</a> <a id="3600" class="Symbol">|</a> <a id="3602" href="ULC.Substitution.html#3580" class="Bound">n</a> <a id="3604" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3606" href="ULC.Substitution.html#3570" class="Bound">y</a>
<a id="3608" class="Symbol">...</a> <a id="3612" class="Symbol">|</a> <a id="3614" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3618" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3623" class="Symbol">|</a> <a id="3625" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3629" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="3636" class="Keyword">rewrite</a> <a id="3644" href="Prelude.DecEq.WithK.html#170" class="Function">≟-refl</a> <a id="3651" class="Bound">y</a>
  <a id="3655" class="Symbol">=</a> <a id="3657" href="Prelude.Setoid.Core.html#470" class="Function">≈-refl</a>
<a id="3664" class="Symbol">...</a> <a id="3668" class="Symbol">|</a> <a id="3670" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3674" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3679" class="Symbol">|</a> <a id="3681" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3684" href="ULC.Substitution.html#3684" class="Bound">n≠y</a>
  <a id="3690" class="Keyword">rewrite</a> <a id="3698" href="Prelude.DecEq.WithK.html#170" class="Function">≟-refl</a> <a id="3705" class="Bound">y</a>
  <a id="3709" class="Symbol">=</a> <a id="3711" href="Prelude.Setoid.Core.html#470" class="Function">≈-refl</a>
<a id="3718" class="Symbol">...</a> <a id="3722" class="Symbol">|</a> <a id="3724" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3727" href="ULC.Substitution.html#3727" class="Bound">n≠x</a> <a id="3731" class="Symbol">|</a> <a id="3733" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3737" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="3744" class="Keyword">rewrite</a> <a id="3752" href="Relation.Nullary.Decidable.Core.html#3296" class="Function">dec-no</a> <a id="3759" class="Symbol">(</a><a id="3760" class="Bound">x</a> <a id="3762" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3764" class="Bound">y</a><a id="3765" class="Symbol">)</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Relation.Binary.PropositionalEquality.Core.html#2310" class="Function">≢-sym</a> <a id="3774" href="ULC.Substitution.html#3727" class="Bound">n≠x</a><a id="3777" class="Symbol">)</a> <a id="3779" class="Symbol">.</a><a id="3780" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
  <a id="3788" class="Symbol">=</a> <a id="3790" class="Hole">{!!}</a> <a id="3795" class="Comment">-- prove with y ♯ N</a>
<a id="3815" class="Symbol">...</a> <a id="3819" class="Symbol">|</a> <a id="3821" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3824" href="ULC.Substitution.html#3824" class="Bound">n≠x</a> <a id="3828" class="Symbol">|</a> <a id="3830" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3833" href="ULC.Substitution.html#3833" class="Bound">n≠y</a>
  <a id="3839" class="Keyword">rewrite</a> <a id="3847" href="Relation.Nullary.Decidable.Core.html#3296" class="Function">dec-no</a> <a id="3854" class="Symbol">(</a><a id="3855" class="Bound">n</a> <a id="3857" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3859" class="Bound">y</a><a id="3860" class="Symbol">)</a> <a id="3862" href="ULC.Substitution.html#3833" class="Bound">n≠y</a> <a id="3866" class="Symbol">.</a><a id="3867" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
  <a id="3875" class="Symbol">=</a> <a id="3877" href="Prelude.Setoid.Core.html#470" class="Function">≈-refl</a>
<a id="3884" href="ULC.Substitution.html#3510" class="Function">swap∘subst</a> <a id="3895" class="Symbol">{</a><a id="3896" href="ULC.Substitution.html#3896" class="Bound">y</a><a id="3897" class="Symbol">}</a> <a id="3899" class="Symbol">{</a><a id="3900" href="ULC.Substitution.html#3900" class="Bound">x</a><a id="3901" class="Symbol">}</a> <a id="3903" class="Symbol">{</a><a id="3904" href="ULC.Substitution.html#3904" class="Bound">L</a> <a id="3906" href="ULC.Base.html#396" class="InductiveConstructor Operator">·</a> <a id="3908" href="ULC.Substitution.html#3908" class="Bound">R</a><a id="3909" class="Symbol">}</a> <a id="3911" class="Symbol">{</a><a id="3912" href="ULC.Substitution.html#3912" class="Bound">M</a><a id="3913" class="Symbol">}</a>
  <a id="3917" class="Symbol">=</a> <a id="3919" href="ULC.Alpha.html#777" class="InductiveConstructor">ξ≡</a> <a id="3922" class="Symbol">(</a><a id="3923" href="ULC.Substitution.html#3510" class="Function">swap∘subst</a> <a id="3934" class="Symbol">{</a><a id="3935" class="Argument">N</a> <a id="3937" class="Symbol">=</a> <a id="3939" href="ULC.Substitution.html#3904" class="Bound">L</a><a id="3940" class="Symbol">})</a> <a id="3943" class="Symbol">(</a><a id="3944" href="ULC.Substitution.html#3510" class="Function">swap∘subst</a> <a id="3955" class="Symbol">{</a><a id="3956" class="Argument">N</a> <a id="3958" class="Symbol">=</a> <a id="3960" href="ULC.Substitution.html#3908" class="Bound">R</a><a id="3961" class="Symbol">})</a>
<a id="3964" href="ULC.Substitution.html#3510" class="Function">swap∘subst</a> <a id="3975" class="Symbol">{</a><a id="3976" href="ULC.Substitution.html#3976" class="Bound">y</a><a id="3977" class="Symbol">}</a> <a id="3979" class="Symbol">{</a><a id="3980" href="ULC.Substitution.html#3980" class="Bound">x</a><a id="3981" class="Symbol">}</a> <a id="3983" class="Symbol">{</a><a id="3984" href="ULC.Base.html#413" class="InductiveConstructor Operator">ƛ</a> <a id="3986" href="ULC.Substitution.html#3986" class="Bound">t̂</a><a id="3988" class="Symbol">}</a> <a id="3990" class="Symbol">{</a><a id="3991" href="ULC.Substitution.html#3991" class="Bound">M</a><a id="3992" class="Symbol">}</a>
<a id="3994" class="Comment">{-
swap y x (ƛ z ⇒ t) [ y / M ]
≡ (ƛ swap y x z ⇒ swap y x t) [ y / M ]
≡ let zˡ = freshAtom (y ∷ supp (swap y z (ƛ z ⇒ t) ++ supp M)
  in ƛ zˡ → conc (swap y x $ abs z t) zˡ [ y / M ]
          ≡ conc (swap y x $ abs z t) zˡ [ swap y x x / M ]
          ≡ conc (swap y x $ abs z t) (swap y x zˡ) [ swap y x x / M ]

≡ let zʳ = freshAtom (x ∷ z ∷ supp t ++ supp M)
  in ƛ zʳ → conc (ƛ z ⇒ t) zʳ [ x / M ]
≡ (ƛ z ⇒ t) [ x / M ]
∎

conc (ƛ zˡ → conc (ƛ swap y x z ⇒ swap y x t) zˡ [ y / M ]) w
≡ swap w zˡ $ conc (ƛ swap y x z ⇒ swap y x t) zˡ [ y / M ]
≡ swap w zˡ $ conc (ƛ swap y x z ⇒ swap y x t) zˡ [ swap y x x / M ]

≡ conc (swap w zˡ $ ƛ swap y x z ⇒ swap y x t) w [ y / M ]
≡ conc (ƛ swap w zˡ (swap y x z) ⇒ swap w zˡ $ swap y x t) w [ y / M ]
≡ conc (ƛ swap w zˡ (swap y x z) ⇒ swap w zˡ $ swap y x t) w [ y / M ]

≈?
≡ swap w z t [ x / M ]
≡ conc (ƛ z ⇒ t) w [ x / M ]
≡ conc (swap w zʳ $ ƛ z ⇒ t) w [ x / M ]
≡ swap w zʳ $ conc (ƛ z ⇒ t) zʳ [ x / M ]
conc (ƛ zʳ → conc (ƛ z ⇒ t) zʳ [ x / M ]) w
-}</a>
  <a id="5005" class="Symbol">=</a> <a id="5007" href="ULC.Alpha.html#867" class="InductiveConstructor Operator">ζ≡</a> <a id="5010" class="Symbol">(</a><a id="5011" class="Hole">{!!}</a> <a id="5016" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5018" class="Symbol">λ</a> <a id="5020" href="ULC.Substitution.html#5020" class="Bound">w</a> <a id="5022" href="ULC.Substitution.html#5022" class="Bound">w∉</a> <a id="5025" class="Symbol">→</a> <a id="5027" class="Hole">{!!}</a><a id="5031" class="Symbol">)</a>
</pre></body></html>